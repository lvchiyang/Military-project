# 某"研建用管维"演示验证系统总体设计说明书

## 1. 项目概述

### 1.1 项目背景
本项目旨在研发某"研建用管维"演示验证系统，提供可视化及"研建用管维"不同模块功能，支撑某系统典型装备"研建用管维"效果展示。系统需要模拟完整的软件开发生命周期，从需求研发到建设、使用、管理和维护的全流程。

### 1.2 设计调整要点
根据设计调整文档要求，本系统将采用以下关键设计调整：
- **技术架构调整**：采用Electron桌面应用架构，通过.exe安装包部署，而非Docker容器化部署
- **应用模拟设计**：用阶段模块作为独立应用，模拟开发应用的使用过程，纯前端实现
- **前后端分离**：明确前端界面功能和后端模块职责，完整梳理业务流程

## 2. 系统架构设计

### 2.1 总体架构

```
┌─────────────────────────────────────────────────────────────┐
│                    Electron 桌面应用                          │
├─────────────────────────────────────────────────────────────┤
│                     前端展示层                               │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐          │
│  │   登录界面   │ │   管理界面   │ │   项目界面   │          │
│  └─────────────┘ └─────────────┘ └─────────────┘          │
│  ┌─────────────────────────────────────────────────────┐   │
│  │              五阶段功能模块                          │   │
│  │  研阶段 │ 建阶段 │ 用阶段 │ 管阶段 │ 维阶段          │   │
│  └─────────────────────────────────────────────────────┘   │
├─────────────────────────────────────────────────────────────┤
│                    后端服务层                               │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐          │
│  │   项目管理   │ │   流程引擎   │ │   数据管理   │          │
│  │   模块      │ │   模块      │ │   模块      │          │
│  └─────────────┘ └─────────────┘ └─────────────┘          │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐          │
│  │   员工管理   │ │   指标计算   │ │   文件管理   │          │
│  │   模块      │ │   模块      │ │   模块      │          │
│  └─────────────┘ └─────────────┘ └─────────────┘          │
├─────────────────────────────────────────────────────────────┤
│                    数据存储层                               │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐          │
│  │   SQLite    │ │   文件存储   │ │   配置文件   │          │
│  │   数据库    │ │   系统      │ │   管理      │          │
│  └─────────────┘ └─────────────┘ └─────────────┘          │
└─────────────────────────────────────────────────────────────┘
```

### 2.2 技术栈选型

| 层级 | 技术选型 | 说明 |
|------|----------|------|
| 桌面框架 | Electron | 跨平台桌面应用开发框架 |
| 前端框架 | Vue 3 + TypeScript | 现代化前端框架，组件化开发 |
| UI组件库 | Element Plus | 成熟的Vue组件库 |
| 状态管理 | Pinia | 轻量级状态管理 |
| 数据可视化 | ECharts + D3.js | 图表展示和复杂动画 |
| 后端框架 | Node.js + Express | 轻量级后端服务 |
| 数据库 | SQLite | 嵌入式数据库，适合桌面应用 |
| 进程通信 | Electron IPC | 主进程与渲染进程通信 |

## 3. 前端功能设计

### 3.1 界面结构设计

#### 3.1.1 登录界面
- **功能**：用户身份认证，角色选择
- **角色类型**：
  - 管理者：可访问所有功能模块
  - 员工：只能访问分配的项目界面
- **界面元素**：
  - 用户名/密码输入框
  - 角色选择下拉框
  - 登录按钮
  - 系统标题和版本信息

#### 3.1.2 管理者主界面
- **项目列表模块**：
  - 显示所有项目的卡片列表
  - 项目状态（进行中/已完成/暂停）
  - 项目基本信息（名称、创建时间、进度）
  - 操作按钮（查看详情、下载里程碑、删除项目）
- **员工列表模块**：
  - 员工基本信息展示
  - 当前分配任务状态
  - 员工绩效评分
- **项目创建模块**：
  - 资源模板选择界面
  - 项目基本信息配置
  - 预算和人员配置

#### 3.1.3 员工界面
- **个人工作台**：
  - 当前分配的项目列表
  - 待处理任务列表
  - 个人绩效统计
- **项目详情访问**：
  - 只能访问分配的项目
  - 查看项目进度和相关文档

#### 3.1.4 项目详情界面
项目详情界面包含四个主要标签页：

**总览标签页**：
- 项目基本信息卡片
- 当前项目资源分配图表
- 项目整体进度环形图
- 核心效能指标仪表盘（4-6个关键指标）
- 项目团队成员状态

**看板标签页**：
- 40个效能指标的实时展示
- 指标分类展示（质量、进度、成本、风险等）
- 指标趋势图表
- 指标异常告警

**项目进度标签页**：
- **左侧**：XML格式时序图，显示完整的研建用管维流程
- **右上角**：当前任务执行员工信息和状态
- **右下角**：
  - 当前任务进度条
  - 当前任务细化事件列表
  - 事件执行日志

**里程碑标签页**：
- 各阶段里程碑列表
- 里程碑文档下载功能
- 阶段成果展示
- 里程碑评审记录

### 3.2 五阶段功能模块设计

#### 3.2.1 研阶段界面
- **需求管理面板**：
  - SRS文档上传区域
  - 需求列表展示
  - 需求状态跟踪
- **需求评价模块**：
  - 大模型评分结果展示
  - 修改建议展示
  - 需求质量评分雷达图
- **方案对比界面**：
  - 多方案参数配置面板
  - 方案对比结果表格
  - 方案评分可视化

#### 3.2.2 建阶段界面
- **时间轴动画展示**：
  - 项目部署流程时间轴
  - 关键路径高亮显示
  - 里程碑节点动画
- **资源监控面板**：
  - 人力资源投入情况
  - 成本消耗实时统计
  - 资源利用率图表
- **风险管理模块**：
  - 风险事件触发按钮
  - 风险应对流程展示
  - 风险预警仪表盘

#### 3.2.3 用阶段界面（独立模拟应用）
**注意**：此阶段作为独立的前端应用，模拟真实的监控系统使用场景

- **监控仪表盘**：
  - 实时数据监控面板
  - 多维度传感器数据展示
  - 设备状态拓扑图
- **告警管理界面**：
  - 实时告警列表
  - 告警级别分类显示
  - 告警处理操作面板
- **数据分析界面**：
  - 历史数据趋势分析
  - 性能指标统计图表
  - 数据导出功能

#### 3.2.4 管阶段界面
- **综合管控面板**：
  - 研建阶段指标汇总
  - 多项目对比视图
  - 资源分配优化建议
- **运维服务管理**：
  - 工单流转状态图
  - 服务请求处理流程
  - 配置管理界面
- **系统拓扑展示**：
  - 系统组成部分可视化
  - 组件关系图谱
  - 依赖关系分析

#### 3.2.5 维阶段界面
- **预测分析面板**：
  - 传感器数据实时展示
  - 预测算法结果可视化
  - 阈值设置和调整界面
- **维护工单管理**：
  - 自动生成的工单列表
  - 工单处理流程跟踪
  - 维护历史记录
- **知识库界面**：
  - 历史解决方案检索
  - 相似问题推荐
  - 解决方案知识图谱

## 4. 后端模块设计

### 4.1 模块划分

#### 4.1.1 项目管理模块
**职责**：管理项目全生命周期数据和状态

**核心功能**：
- 项目创建、删除、状态更新
- 项目配置管理（资源模板、预算设置）
- 项目数据持久化存储
- 多项目并发支持

**数据结构**：
```typescript
interface Project {
  id: string;
  name: string;
  status: 'running' | 'completed' | 'paused';
  budget: number;
  remainingBudget: number;
  createdAt: Date;
  currentPhase: 'research' | 'build' | 'use' | 'manage' | 'maintain';
  resourceTemplate: ResourceTemplate;
  team: Employee[];
  milestones: Milestone[];
}
```

#### 4.1.2 流程引擎模块
**职责**：控制项目执行流程和任务调度

**核心功能**：
- 项目流程配置解析（基于配置文件）
- 任务自动调度和执行
- 流程状态管理和更新
- 事件触发和处理机制

**关键特性**：
- 支持手动和自动两种执行模式
- 可配置的任务执行速度
- 事件驱动的流程推进

#### 4.1.3 员工管理模块
**职责**：管理员工信息、任务分配和绩效计算

**核心功能**：
- 员工基本信息管理
- 任务分配和负责人指定
- 工资计算和预算扣除
- 员工绩效评分统计

**数据结构**：
```typescript
interface Employee {
  id: string;
  name: string;
  role: 'research' | 'build' | 'use' | 'manage' | 'maintain';
  dailySalary: number;
  efficiency: number; // 工作效率系数
  currentTasks: Task[];
  totalScore: number;
  status: 'working' | 'idle' | 'offline';
}
```

#### 4.1.4 指标计算模块
**职责**：计算和维护40个效能指标

**核心功能**：
- 指标定义和计算规则管理
- 实时指标数据计算
- 指标历史数据存储
- 指标异常检测和告警

**指标分类**：
- 质量指标（需求完成度、缺陷密度等）
- 进度指标（计划完成率、延期率等）
- 成本指标（预算使用率、人力成本等）
- 风险指标（风险发生率、影响程度等）

#### 4.1.5 数据管理模块
**职责**：数据存储、检索和文件管理

**核心功能**：
- SQLite数据库操作封装
- 文件上传和存储管理
- 数据备份和恢复
- 数据导入导出功能

#### 4.1.6 文件管理模块
**职责**：处理文档和里程碑文件

**核心功能**：
- SRS文档解析和处理
- 里程碑文件生成和存储
- 项目文档版本管理
- 文件下载和打包功能

### 4.2 后端运行逻辑

#### 4.2.1 项目执行流程
1. **项目创建**：
   - 根据资源模板创建项目实例
   - 初始化项目数据结构
   - 分配初始团队成员
   - 创建项目专属文件夹

2. **流程执行**：
   - 读取流程配置文件
   - 按阶段顺序执行任务
   - 每个任务指定负责员工
   - 根据员工效率计算完成时间

3. **事件处理**：
   - 监听任务完成事件
   - 更新相关效能指标
   - 触发下一个任务
   - 生成里程碑文件

4. **异常处理**：
   - 预算不足时暂停项目
   - 处理意外事件（需求变更、Bug发现）
   - 触发相应的处理流程

#### 4.2.2 多线程支持
- 每个项目运行在独立线程中
- 项目间数据隔离
- 共享员工资源池
- 线程安全的数据访问

## 5. 关键技术实现

### 5.1 手动/自动执行模式实现
**执行模式设计**：
- **手动模式**：所有任务进展需要用户手动点击触发，完全由用户控制项目节奏
- **自动模式**：系统自动填充任务数据和进度，但需用户确认后才正式更新，确保用户对过程的掌控
- **混合模式**：自动执行基础流程，允许用户随时手动干预和调整，平衡效率和控制性

**实现逻辑**：自动模式下系统会根据任务类型生成相应的进度数据、事件序列和指标影响，然后通过前端对话框展示给用户确认，用户可以选择确认使用、修改数据或重新生成。

### 5.2 任务事件模板机制
**事件模板设计**：基于《研建用管维角色关系与效能指标体系分析.md》中的17个关键任务，每个任务细化为具体的事件序列。例如编码实现任务包含：代码框架搭建→核心功能开发→代码提交→单元测试→代码审查→分支合并→构建失败→问题修复→构建成功等事件。

**影响计算**：每个事件都有明确的持续时间和对效能指标的影响值，支持正面影响（如代码提交增加版本控制分数）和负面影响（如构建失败降低构建稳定性）。

### 5.3 意外事件模拟机制
**事件类型**：设计需求变更、严重Bug发现、人员短缺、技术难题等四类主要意外事件，每类事件都有发生概率、适用阶段、影响系数和应对措施。

**触发逻辑**：系统在项目执行过程中按概率随机检查是否触发意外事件，触发后会调整项目参数（如延长时间、增加成本、影响质量），并执行相应的应对措施（如触发变更流程、启动紧急修复、重新分配资源等）。

### 5.4 其他开销模拟实现
**开销分类**：
- 固定开销（办公室租金、设备折旧、软件许可）：每日固定扣除
- 变动开销（水电费、通讯费）：根据团队规模按比例计算
- 偶发开销（培训费用、会议成本）：按20%概率随机发生

**预算影响**：所有开销都会从项目预算中实时扣除，当预算不足时项目自动暂停，模拟真实项目的资金约束。

### 5.5 Electron架构实现
```typescript
// 主进程：应用生命周期管理
class MainProcess {
  createWindow(): void;
  setupIPC(): void;
  initializeDatabase(): void;
  startBackendService(): void;
}

// 渲染进程：前端界面
class RendererProcess {
  initializeVue(): void;
  setupRouting(): void;
  connectToBackend(): void;
}
```

### 5.2 进程间通信（IPC）
```typescript
// 主进程到渲染进程
ipcMain.handle('project:create', async (event, projectData) => {
  return await projectService.createProject(projectData);
});

// 渲染进程到主进程
const result = await ipcRenderer.invoke('project:create', projectData);
```

### 5.3 实时数据更新
```typescript
// WebSocket风格的实时通信
class RealtimeService {
  broadcastMetricUpdate(projectId: string, metrics: any): void;
  subscribeToProject(projectId: string, callback: Function): void;
  unsubscribeFromProject(projectId: string): void;
}
```

## 6. 数据库设计

### 6.1 主要数据表

```sql
-- 项目表
CREATE TABLE projects (
  id TEXT PRIMARY KEY,
  name TEXT NOT NULL,
  status TEXT NOT NULL,
  budget REAL NOT NULL,
  remaining_budget REAL NOT NULL,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  current_phase TEXT NOT NULL,
  config TEXT -- JSON格式的配置信息
);

-- 员工表
CREATE TABLE employees (
  id TEXT PRIMARY KEY,
  name TEXT NOT NULL,
  role TEXT NOT NULL,
  daily_salary REAL NOT NULL,
  efficiency REAL DEFAULT 1.0,
  total_score INTEGER DEFAULT 0,
  status TEXT DEFAULT 'idle'
);

-- 任务表
CREATE TABLE tasks (
  id TEXT PRIMARY KEY,
  project_id TEXT NOT NULL,
  name TEXT NOT NULL,
  phase TEXT NOT NULL,
  assigned_employee_id TEXT,
  status TEXT DEFAULT 'pending',
  start_time DATETIME,
  end_time DATETIME,
  FOREIGN KEY (project_id) REFERENCES projects(id),
  FOREIGN KEY (assigned_employee_id) REFERENCES employees(id)
);

-- 效能指标表
CREATE TABLE metrics (
  id TEXT PRIMARY KEY,
  project_id TEXT NOT NULL,
  metric_name TEXT NOT NULL,
  metric_value REAL NOT NULL,
  recorded_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (project_id) REFERENCES projects(id)
);

-- 里程碑表
CREATE TABLE milestones (
  id TEXT PRIMARY KEY,
  project_id TEXT NOT NULL,
  phase TEXT NOT NULL,
  name TEXT NOT NULL,
  file_path TEXT,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (project_id) REFERENCES projects(id)
);
```

## 7. 配置文件设计

### 7.1 流程配置文件
```json
{
  "phases": [
    {
      "name": "research",
      "displayName": "研阶段",
      "tasks": [
        {
          "id": "req_analysis",
          "name": "需求分析",
          "duration": 5,
          "requiredRole": "research",
          "events": [
            "需求文档上传",
            "需求评估",
            "需求确认"
          ]
        }
      ]
    }
  ]
}
```

### 7.2 资源模板配置
```json
{
  "templates": [
    {
      "name": "标准配置",
      "budget": 100000,
      "team": {
        "research": 1,
        "build": 5,
        "use": 1,
        "manage": 1,
        "maintain": 1
      },
      "timeMultiplier": 1.0
    }
  ]
}
```

## 8. 部署方案

### 8.1 Electron应用打包
- 使用electron-builder进行应用打包
- 生成Windows .exe安装包
- 包含所有依赖和资源文件
- 支持自动更新机制

### 8.2 安装部署流程
1. 双击.exe安装包
2. 选择安装路径
3. 自动初始化数据库
4. 创建桌面快捷方式
5. 首次运行配置向导

## 9. 性能指标

### 9.1 响应时间要求
- 界面切换响应时间 < 1秒
- 数据查询响应时间 < 3秒
- 文件上传处理时间 < 5秒
- 实时数据更新延迟 < 500ms

### 9.2 并发支持
- 支持多项目同时运行
- 单机支持10个并发项目
- 内存占用 < 2GB
- CPU占用率 < 50%

## 10. 安全性设计

### 10.1 数据安全
- SQLite数据库加密
- 敏感信息本地加密存储
- 文件访问权限控制
- 数据备份和恢复机制

### 10.2 应用安全
- 用户身份认证
- 角色权限控制
- 操作日志记录
- 防止SQL注入和XSS攻击

## 11. 扩展性设计

### 11.1 模块化设计
- 插件化架构支持
- 配置驱动的流程定义
- 可扩展的指标计算框架
- 灵活的界面组件系统

### 11.2 接口设计
- 标准化的API接口
- 支持第三方系统集成
- 数据导入导出接口
- 外部工具集成能力

## 12. 总结

本总体设计说明书基于设计调整文档的要求，将原有的Web应用架构调整为Electron桌面应用架构，明确了前后端的职责分工和业务流程。系统采用模块化设计，支持多项目并发运行，能够有效演示"研建用管维"全生命周期的各个环节，满足甲方的演示验证需求。

通过本设计方案，系统将具备良好的可扩展性、稳定性和用户体验，能够为装备全生命周期管理提供有效的演示验证平台。
